import numpy as np

from utils.plot import Plot

data = np.array([
    [0,
     0.02,
     0.04,
     0.06,
     0.08,
     0.1,
     0.12,
     0.14,
     0.16,
     0.18,
     0.2,
     0.22,
     0.24,
     0.26,
     0.28,
     0.3,
     0.32,
     0.34,
     0.36,
     0.38,
     0.4,
     0.42,
     0.44,
     0.46,
     0.48,
     0.5,
     0.52,
     0.54,
     0.56,
     0.58,
     0.6,
     0.62,
     0.64,
     0.66,
     0.68,
     0.7,
     0.72,
     0.74,
     0.76,
     0.78,
     0.8,
     0.82,
     0.84,
     0.86,
     0.88,
     0.9,
     0.92,
     0.94,
     0.960000000000001,
     0.98,
     1]

    , [1.64783944608624,
       1.52864047700043,
       1.41587010791332,
       1.3093049598151,
       1.20872546247746,
       1.11391643048286,
       1.02466785165588,
       0.940775885190352,
       0.862044067450714,
       0.788284723834384,
       0.719320585356564,
       0.654986608816376,
       0.595131999553167,
       0.539622435919769,
       0.488342494695152,
       0.441198276738463,
       0.398120232254023,
       0.359066185095373,
       0.32402455558812,
       0.293017781397564,
       0.266105936009415,
       0.243390544431015,
       0.225018595757536,
       0.211186752283144,
       0.202145754871941,
       0.198205024338204,
       0.1997374586208,
       0.20718442557333,
       0.221060951230466,
       0.241961103452962,
       0.270563570900233,
       0.30763743733159,
       0.354048151297071,
       0.410763691348809,
       0.478860926987148,
       0.559532175656722,
       0.65409195623239,
       0.763983939591809,
       0.890788097072674,
       1.0362280478763,
       1.20217860683251,
       1.39067353442619,
       1.60391349167268,
       1.84427420343331,
       2.11431483529107,
       2.41678659155014,
       2.75464154607921,
       3.13104172538928,
       3.54936847921508,
       4.01323221310737,
       4.5264826947148]
]

)

fit = np.polyfit(data[0], data[1], 3, full=True)
print(fit)

fitted = np.array(data)
fitted[1] = fit[0][0] * data[0] ** 3 + fit[0][1] * data[0] ** 2 + fit[0][2] * data[0] + fit[0][3]
# fitted[1] = fit[0][2]*data[0]+fit[0][3]
print(fitted)

plot = Plot(xlim=(0, 1))
plot.add_plot(data, "original")
plot.add_plot(fitted, "fitted")
plot.show()
